<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Testcontainers-Dotnet: README</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Testcontainers-Dotnet
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">README </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p ><a href="https://www.nuget.org/packages/Testcontainers"><img src="https://img.shields.io/nuget/v/Testcontainers.svg" alt="NuGet" style="pointer-events: none;" class="inline"/></a> <a href="https://www.nuget.org/packages/Testcontainers"><img src="https://img.shields.io/nuget/vpre/Testcontainers.svg" alt="NuGet" style="pointer-events: none;" class="inline"/></a> <a href="https://github.com/testcontainers/testcontainers-dotnet/actions/workflows/cicd.yml"><img src="https://github.com/testcontainers/testcontainers-dotnet/actions/workflows/cicd.yml/badge.svg?branch=develop" alt="Continuous Integration" style="pointer-events: none;" class="inline"/></a> <a href="https://sonarcloud.io/summary/new_code?id=testcontainers_testcontainers-dotnet"><img src="https://sonarcloud.io/api/project_badges/measure?project=testcontainers_testcontainers-dotnet&amp;metric=alert_status" alt="Quality Gate Status" class="inline"/></a> <a href="https://sonarcloud.io/summary/new_code?id=testcontainers_testcontainers-dotnet"><img src="https://sonarcloud.io/api/project_badges/measure?project=testcontainers_testcontainers-dotnet&amp;metric=coverage" alt="Coverage" class="inline"/></a></p>
<h1><a class="anchor" id="autotoc_md22"></a>
Testcontainers</h1>
<p >Testcontainers is a library to support tests with throwaway instances of Docker containers for all compatible .NET Standard versions. The library is built on top of the .NET Docker remote API and provides a lightweight implementation to support your test environment in all circumstances.</p>
<p >Choose from existing pre-configured configurations and start containers within a second, to support and run your tests. Or create your own containers with Dockerfiles and run your tests immediately afterward.</p>
<h2><a class="anchor" id="autotoc_md23"></a>
Supported operating systems</h2>
<p >Testcontainers supports Windows, Linux, and macOS as host systems. Linux Docker containers are supported on all three operating systems.</p>
<p >Native Windows Docker containers are only supported on Windows. Windows requires the host operating system version to match the container operating system version. You'll find further information about Windows container version compatibility <a href="https://docs.microsoft.com/en-us/virtualization/windowscontainers/deploy-containers/version-compatibility">here</a>.</p>
<p >Keep in mind to enable the correct Docker engine on Windows host systems to match the container operating system. With Docker Desktop you can switch the engine either with the tray icon context menu or: <code>$env:ProgramFiles\Docker\Docker\DockerCli.exe -SwitchDaemon</code> or <code>-SwitchLinuxEngine</code>, <code>-SwitchWindowsEngine</code>.</p>
<h2><a class="anchor" id="autotoc_md24"></a>
Supported commands</h2>
<p >To configure a container, use the <code>TestcontainersBuilder&lt;TestcontainersContainer&gt;</code> builder, that provides:</p>
<ul>
<li><code>WithImage</code> specifies an <code>IMAGE[:TAG]</code> to derive the container from.</li>
<li><code>WithWorkingDirectory</code> specifies and overrides the <code>WORKDIR</code> for the instruction sets.</li>
<li><code>WithEntrypoint</code> specifies and overrides the <code>ENTRYPOINT</code> that will run as an executable.</li>
<li><code>WithCommand</code> specifies and overrides the <code>COMMAND</code> instruction provided from the Dockerfile.</li>
<li><code>WithName</code> sets the container name e.g. <code>--name nginx</code>.</li>
<li><code>WithHostname</code> sets the container hostname e.g. <code>--hostname my-nginx</code>.</li>
<li><code>WithEnvironment</code> sets an environment variable in the container e.g. <code>-e, --env "test=containers"</code>.</li>
<li><code>WithLabel</code> applies metadata to the container e.g. <code>-l, --label testcontainers=awesome</code>.</li>
<li><code>WithExposedPort</code> exposes a port inside the container e.g. <code>--expose=80</code>.</li>
<li><code>WithPortBinding</code> publishes the container port to the host e.g. <code>-p, --publish 80:80</code>.</li>
<li><code>WithBindMount</code> binds a path of a file or directory into the container e.g. <code>-v, --volume .:/tmp</code>.</li>
<li><code>WithVolumeMount</code> mounts a managed volume into the container e.g. <code>--mount type=volume,source=.,destination=/tmp</code>.</li>
<li><code>WithNetwork</code> assigns a network to the container e.g. <code>--network="bridge"</code>.</li>
<li><code>WithNetworkAliases</code> assigns a network-scoped aliases to the container e.g. <code>--network-alias alias</code></li>
<li><code>WithDockerEndpoint</code> sets the Docker API endpoint e.g. <code>-H tcp://0.0.0.0:2376</code>.</li>
<li><code>WithRegistryAuthentication</code> basic authentication against a private Docker registry.</li>
<li><code>WithOutputConsumer</code> redirects <code>stdout</code> and <code>stderr</code> to capture the container output.</li>
<li><code>WithWaitStrategy</code> sets the wait strategy to complete the container start and indicates when it is ready.</li>
<li><code>WithStartupCallback</code> sets the startup callback to invoke after the container start.</li>
<li><code>WithPrivileged</code> sets the <code>--privileged</code> flag.</li>
<li><code>WithAutoRemove</code> will remove the stopped container automatically like <code>--rm</code>.</li>
<li><code>WithCleanUp</code> will remove the container automatically after all tests have been run (see Resource Reaper).</li>
<li><code>WithResourceReaperSessionId</code> assigns a Resource Reaper session id to the container.</li>
</ul>
<p >Use the additional builder for image (<code>ImageFromDockerfileBuilder</code>), network (<code>TestcontainersNetworkBuilder</code>) and volume (<code>TestcontainersVolumeBuilder</code>) to set up your individual test environment.</p>
<h2><a class="anchor" id="autotoc_md25"></a>
Resource Reaper</h2>
<p >Testcontainers assigns each Docker resource a Resource Reaper session id. After the tests are finished, <a href="https://github.com/testcontainers/moby-ryuk">Ryuk</a> will take care of remaining Docker resources and removes them. You can change the Resource Reaper session and group Docker resources together with <code>WithResourceReaperSessionId</code>. Right now, only Linux containers are supported.</p>
<h2><a class="anchor" id="autotoc_md26"></a>
Pre-configured containers</h2>
<p >The pre-configured Testcontainers below are supported. Further examples can be found in <a href="https://github.com/testcontainers/testcontainers-dotnet/blob/develop/tests/Testcontainers.Tests/Unit/Containers/Unix/TestcontainersContainerTest.cs">TestcontainersContainerTest</a> as well as in <a href="https://github.com/testcontainers/testcontainers-dotnet/blob/develop/tests/Testcontainers.Tests/Unit/Containers/Unix/Modules/Databases">database</a> or <a href="https://github.com/testcontainers/testcontainers-dotnet/blob/develop/tests/Testcontainers.Tests/Unit/Containers/Unix/Modules/MessageBrokers">message broker</a> tests.</p>
<ul>
<li>Apache CouchDB (couchdb:2.3.1)</li>
<li>Couchbase (couchbase:6.5.1)</li>
<li>Elasticsearch (elasticsearch:8.3.2)</li>
<li>MariaDB (mariadb:10.8)</li>
<li>Microsoft SQL Server (mcr.microsoft.com/mssql/server:2017-CU28-ubuntu-16.04)</li>
<li>MongoDB (mongo:5.0.6)</li>
<li>MySQL (mysql:8.0.28)</li>
<li>Oracle Database (wnameless/oracle-xe-11g-r2)</li>
<li>PostgreSQL (postgres:11.14)</li>
<li>Redis (redis:5.0.14)</li>
<li>Apache Kafka (confluentinc/cp-kafka:6.0.5)</li>
<li>RabbitMQ (rabbitmq:3.7.28)</li>
</ul>
<h2><a class="anchor" id="autotoc_md27"></a>
Examples</h2>
<p >Pulls <code>nginx</code>, creates a new container with port binding <code>80:80</code> and hits the default site.</p>
<div class="fragment"><div class="line">var testcontainersBuilder = <span class="keyword">new</span> TestcontainersBuilder&lt;TestcontainersContainer&gt;()</div>
<div class="line">  .WithImage(<span class="stringliteral">&quot;nginx&quot;</span>)</div>
<div class="line">  .WithName(<span class="stringliteral">&quot;nginx&quot;</span>)</div>
<div class="line">  .WithPortBinding(80)</div>
<div class="line">  .WithWaitStrategy(Wait.ForUnixContainer().UntilPortIsAvailable(80));</div>
<div class="line"> </div>
<div class="line">await <span class="keyword">using</span> (var testcontainers = testcontainersBuilder.Build())</div>
<div class="line">{</div>
<div class="line">  await testcontainers.StartAsync();</div>
<div class="line">  _ = WebRequest.Create(<span class="stringliteral">&quot;http://localhost:80&quot;</span>);</div>
<div class="line">}</div>
</div><!-- fragment --><p >Mounts the current directory as volume into the container and runs <code>hostname &gt; /tmp/hostname</code> on startup.</p>
<div class="fragment"><div class="line">var testcontainersBuilder = <span class="keyword">new</span> TestcontainersBuilder&lt;TestcontainersContainer&gt;()</div>
<div class="line">  .WithImage(<span class="stringliteral">&quot;nginx&quot;</span>)</div>
<div class="line">  .WithName(<span class="stringliteral">&quot;nginx&quot;</span>)</div>
<div class="line">  .WithBindMount(<span class="stringliteral">&quot;.&quot;</span>, <span class="stringliteral">&quot;/tmp&quot;</span>)</div>
<div class="line">  .WithEntrypoint(<span class="stringliteral">&quot;/bin/sh&quot;</span>, <span class="stringliteral">&quot;-c&quot;</span>)</div>
<div class="line">  .WithCommand(<span class="stringliteral">&quot;hostname &gt; /tmp/hostname&quot;</span>)</div>
<div class="line">  .WithWaitStrategy(Wait.ForUnixContainer().UntilFileExists(<span class="stringliteral">&quot;/tmp/hostname&quot;</span>));</div>
<div class="line"> </div>
<div class="line">await <span class="keyword">using</span> (var testcontainers = testcontainersBuilder.Build())</div>
<div class="line">{</div>
<div class="line">  await testcontainers.StartAsync();</div>
<div class="line">}</div>
</div><!-- fragment --><p >Here is an example of a pre-configured container. In the example, Testcontainers starts a PostgreSQL database in a <a href="https://xunit.net">xUnit.net</a> test and executes a SQL query.</p>
<div class="fragment"><div class="line"><span class="keyword">public</span> sealed <span class="keyword">class </span>PostgreSqlTest : IAsyncLifetime</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">private</span> readonly TestcontainerDatabase testcontainers = <span class="keyword">new</span> TestcontainersBuilder&lt;PostgreSqlTestcontainer&gt;()</div>
<div class="line">    .WithDatabase(<span class="keyword">new</span> PostgreSqlTestcontainerConfiguration</div>
<div class="line">    {</div>
<div class="line">      Database = <span class="stringliteral">&quot;db&quot;</span>,</div>
<div class="line">      Username = <span class="stringliteral">&quot;postgres&quot;</span>,</div>
<div class="line">      Password = <span class="stringliteral">&quot;postgres&quot;</span>,</div>
<div class="line">    })</div>
<div class="line">    .Build();</div>
<div class="line"> </div>
<div class="line">  [Fact]</div>
<div class="line">  <span class="keyword">public</span> <span class="keywordtype">void</span> ExecuteCommand()</div>
<div class="line">  {</div>
<div class="line">    <span class="keyword">using</span> (var connection = <span class="keyword">new</span> NpgsqlConnection(this.testcontainers.ConnectionString))</div>
<div class="line">    {</div>
<div class="line">      <span class="keyword">using</span> (var command = <span class="keyword">new</span> NpgsqlCommand())</div>
<div class="line">      {</div>
<div class="line">        connection.Open();</div>
<div class="line">        command.Connection = connection;</div>
<div class="line">        command.CommandText = <span class="stringliteral">&quot;SELECT 1&quot;</span>;</div>
<div class="line">        command.ExecuteReader();</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">public</span> Task InitializeAsync()</div>
<div class="line">  {</div>
<div class="line">    <span class="keywordflow">return</span> this.testcontainers.StartAsync();</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">public</span> Task DisposeAsync()</div>
<div class="line">  {</div>
<div class="line">    <span class="keywordflow">return</span> this.testcontainers.DisposeAsync().AsTask();</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><p >The implementation of the pre-configured wait strategies can be chained together to support individual requirements for Testcontainers with different container platform operating systems.</p>
<div class="fragment"><div class="line">Wait.ForUnixContainer()</div>
<div class="line">  .UntilPortIsAvailable(80)</div>
<div class="line">  .UntilFileExists(<span class="stringliteral">&quot;/tmp/foo&quot;</span>)</div>
<div class="line">  .UntilFileExists(<span class="stringliteral">&quot;/tmp/bar&quot;</span>)</div>
<div class="line">  .UntilOperationIsSucceeded(() =&gt; <span class="keyword">true</span>, 1);</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md28"></a>
Logging</h2>
<p >To enable and configure logging, set the static <code>TestcontainersSettings.Logger</code> property before test execution.</p>
<h2><a class="anchor" id="autotoc_md29"></a>
Contributing</h2>
<p >See <a class="el" href="md__c_o_n_t_r_i_b_u_t_i_n_g.html">CONTRIBUTING.md</a></p>
<h2><a class="anchor" id="autotoc_md30"></a>
Authors</h2>
<ul>
<li><b>Andre Hofmeister</b> - <em>Initial work</em> - <a href="https://github.com/HofmeisterAn/">HofmeisterAn</a></li>
</ul>
<h2><a class="anchor" id="autotoc_md31"></a>
Thanks</h2>
<p >Many thanks to <a href="https://www.jetbrains.com/?from=testcontainers-dotnet">JetBrains</a> who provide an <a href="https://www.jetbrains.com/community/opensource/">Open Source License</a> for this project :heart:.</p>
<h2><a class="anchor" id="autotoc_md32"></a>
License</h2>
<p >This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4
</small></address>
</body>
</html>
